"use strict";var ID="K9V7O9NLGG3GP",ColorList=["黑色","深棕","灰色","白色","深蓝","浅灰","粉色","卡其","藕粉","薄荷色","抹茶绿","木炭灰","驼色","杏色","咖啡","卡其","棕色","黄色","浅蓝色","绿色","克莱因蓝"],PushBlackPrintsList=["白色","黄色","杏色","驼色","抹茶绿","浅灰","卡其"],console={_NotLog:!1,_setLogFile:null,log:function(e){this._NotLog||(this._setLogFile?this._setLogFile(e):$.writeln(e))},error:function(e){this._NotLog||alert(e)},fileOut:null,setLogFile:function(e){var t=new File(e);t.open("a+","TEXT","????"),this._setLogFile=function(e){t.write(e+"\n"||"log=> Not:data \n")},this.fileOut=t}},HM={Web_JPEG_ExportSlice:function(e,t){var n=function(e){return app.charIDToTypeID(e)},o=function(e){return app.stringIDToTypeID(e)};!function(a,r){if(null==a||a){var i=r?DialogModes.ALL:DialogModes.NO,c=new ActionDescriptor,u=new ActionDescriptor;u.putEnumerated(n("Op  "),n("SWOp"),n("OpSa")),u.putBoolean(n("DIDr"),!0),u.putPath(n("In  "),new File(e||"~/Pictures/Saved Pictures/kiic")),u.putEnumerated(n("Fmt "),n("IRFm"),o("JPEGFormat")),u.putBoolean(n("Intr"),!1),u.putInteger(n("Qlty"),100),u.putInteger(n("QChS"),0),u.putInteger(n("QCUI"),0),u.putBoolean(n("QChT"),!1),u.putBoolean(n("QChV"),!1),u.putBoolean(n("Optm"),!0),u.putInteger(n("Pass"),1),u.putDouble(n("blur"),0),u.putBoolean(n("Mtt "),!0),u.putBoolean(n("EICC"),!1),u.putInteger(n("MttR"),255),u.putInteger(n("MttG"),255),u.putInteger(n("MttB"),255),u.putBoolean(n("SHTM"),!1),u.putBoolean(n("SImg"),!0),u.putEnumerated(n("SWsl"),n("STsl"),n("SLAl")),u.putEnumerated(n("SWch"),n("STch"),n("CHsR")),u.putEnumerated(n("SWmd"),n("STmd"),n("MDCC")),u.putBoolean(n("ohXH"),!1),u.putBoolean(n("ohIC"),!0),u.putBoolean(n("ohAA"),!0),u.putBoolean(n("ohQA"),!0),u.putBoolean(n("ohCA"),!1),u.putBoolean(n("ohIZ"),!0),u.putEnumerated(n("ohTC"),n("SToc"),n("OC03")),u.putEnumerated(n("ohAC"),n("SToc"),n("OC03")),u.putInteger(n("ohIn"),-1),u.putEnumerated(n("ohLE"),n("STle"),n("LE03")),u.putEnumerated(n("ohEn"),n("STen"),n("EN00")),u.putBoolean(n("olCS"),!1),u.putEnumerated(n("olEC"),n("STst"),n("ST00")),u.putEnumerated(n("olWH"),n("STwh"),n("WH01")),u.putEnumerated(n("olSV"),n("STsp"),n("SP04")),u.putEnumerated(n("olSH"),n("STsp"),n("SP04"));var p=new ActionList,l=new ActionDescriptor;l.putEnumerated(n("ncTp"),n("STnc"),n("NC00")),p.putObject(n("SCnc"),l);var s=new ActionDescriptor;s.putEnumerated(n("ncTp"),n("STnc"),n("NC19")),p.putObject(n("SCnc"),s);var v=new ActionDescriptor;v.putEnumerated(n("ncTp"),n("STnc"),n("NC28")),p.putObject(n("SCnc"),v);var D=new ActionDescriptor;D.putEnumerated(n("ncTp"),n("STnc"),n("NC24")),p.putObject(n("SCnc"),D);var d=new ActionDescriptor;d.putEnumerated(n("ncTp"),n("STnc"),n("NC24")),p.putObject(n("SCnc"),d);var h=new ActionDescriptor;h.putEnumerated(n("ncTp"),n("STnc"),n("NC24")),p.putObject(n("SCnc"),h),u.putList(n("olNC"),p),u.putBoolean(n("obIA"),!1),u.putString(n("obIP"),""),u.putEnumerated(n("obCS"),n("STcs"),n("CS01"));var m=new ActionList,T=new ActionDescriptor;T.putEnumerated(n("ncTp"),n("STnc"),n("NC01")),m.putObject(n("SCnc"),T);var S=new ActionDescriptor;S.putEnumerated(n("ncTp"),n("STnc"),n("NC20")),m.putObject(n("SCnc"),S);var f=new ActionDescriptor;f.putEnumerated(n("ncTp"),n("STnc"),n("NC02")),m.putObject(n("SCnc"),f);var A=new ActionDescriptor;A.putEnumerated(n("ncTp"),n("STnc"),n("NC19")),m.putObject(n("SCnc"),A);var I=new ActionDescriptor;I.putEnumerated(n("ncTp"),n("STnc"),n("NC06")),m.putObject(n("SCnc"),I);var y=new ActionDescriptor;y.putEnumerated(n("ncTp"),n("STnc"),n("NC24")),m.putObject(n("SCnc"),y);var g=new ActionDescriptor;g.putEnumerated(n("ncTp"),n("STnc"),n("NC24")),m.putObject(n("SCnc"),g);var E=new ActionDescriptor;E.putEnumerated(n("ncTp"),n("STnc"),n("NC24")),m.putObject(n("SCnc"),E);var w=new ActionDescriptor;w.putEnumerated(n("ncTp"),n("STnc"),n("NC22")),m.putObject(n("SCnc"),w),u.putList(n("ovNC"),m),u.putBoolean(n("ovCM"),!1),u.putBoolean(n("ovCW"),!0),u.putBoolean(n("ovCU"),!0),u.putBoolean(n("ovSF"),!0),u.putBoolean(n("ovCB"),!0),u.putString(n("ovSN"),t||"images"),c.putObject(n("Usng"),o("SaveForWeb"),u),executeAction(o("export"),c,i)}}(void 0,void 0)},FormatPath:function(e){return e.replace(/[\\\/]+/,"\\").replace(/[\\\/]+$/,"")},SaveLayerToJPEG:function(e,t){this.Layer.Show(t),this.SaveAsToJPEG(e),this.Layer.Hide(t)},SaveLayerToPNG:function(e,t){this.Layer.Show(t),this.SaveAsToPNG(e),this.Layer.Hide(t)},SaveAsToJPEG:function(e,t){var n=t?this.FormatPath(e+"/"+t):this.FormatPath(e);console.log("SaveAsToJPEG=> ".concat(n));var o=function(e){return app.charIDToTypeID(e)},a=function(e){return app.stringIDToTypeID(e)},r=new ActionDescriptor,i=new ActionDescriptor;i.putInteger(o("EQlt"),12),i.putEnumerated(o("MttC"),o("MttC"),o("None")),r.putObject(o("As  "),a("JPEGFormat"),i),r.putPath(o("In  "),new File(n)),r.putInteger(o("DocI"),228),r.putBoolean(o("Cpy "),!0),executeAction(a("save"),r)},SaveAsToPNG:function(e,t){var n=t?this.FormatPath(e+"/"+t):this.FormatPath(e);console.log("SaveAsToPNG=> ".concat(n));var o=function(e){return app.charIDToTypeID(e)},a=function(e){return app.stringIDToTypeID(e)},r=new ActionDescriptor,i=new ActionDescriptor;i.putEnumerated(o("Mthd"),a("PNGMethod"),a("quick")),i.putEnumerated(a("PNGInterlaceType"),a("PNGInterlaceType"),a("PNGInterlaceNone")),i.putEnumerated(a("PNGFilter"),a("PNGFilter"),a("PNGFilterAdaptive")),i.putInteger(o("Cmpr"),6),r.putObject(o("As  "),a("PNGFormat"),i),r.putPath(o("In  "),new File(n)),r.putInteger(o("DocI"),228),r.putBoolean(o("Cpy "),!0),executeAction(a("save"),r)},evalJavaScript:function(e){var t=stringIDToTypeID("AdobeScriptAutomation Scripts"),n=new ActionDescriptor,o=charIDToTypeID("jsCt");n.putPath(o,new File(e)),executeAction(t,n,DialogModes.NO)},fs:{exists:function(e){return Folder(e).exists},writeFile:function(e,t,n){var o=new File(e);o.open(n||"a+","TEXT","????"),o.write(t||""),o.close()},mkDir:function(e){var t=Folder(e);t.exists||t.create()}},envDoc:{AllLayers:function(){var e,t=[];return function e(n){for(var o=0,a=n;o<a.length;o++){var r=a[o];t.push(r),"LayerSet"==r.typename&&e((null==r?void 0:r.layers)||[])}}((null===(e=null===app||void 0===app?void 0:app.activeDocument)||void 0===e?void 0:e.layers)||[]),t}},ForEach:function(e,t){for(var n=-1,o=0,a=e;o<a.length;o++){var r=a[o];t&&t.apply(e,[r,n++])}},Layer:{active:function(){var e;try{return(null===(e=null===app||void 0===app?void 0:app.activeDocument)||void 0===e?void 0:e.activeLayer)||null}catch(e){return null}},Select:function(e){var t=charIDToTypeID("slct"),n=new ActionDescriptor,o=charIDToTypeID("null"),a=new ActionReference,r=charIDToTypeID("Lyr ");a.putName(r,e),n.putReference(o,a);var i=charIDToTypeID("MkVs");n.putBoolean(i,!1);var c=charIDToTypeID("LyrI"),u=new ActionList;u.putInteger(1408),n.putList(c,u),executeAction(t,n,DialogModes.NO)},EditSmartObject:function(e){e&&this.Select(e);var t=stringIDToTypeID("placedLayerEditContents"),n=new ActionDescriptor;executeAction(t,n,DialogModes.NO)},SetName:function(e,t){t&&this.Select(t);var n=this.active();n&&(n.name=e)},Hide:function(e){if(e instanceof Array)for(var t=0,n=e;t<n.length;t++){var o=n[t];this.Hide(o)}else{var a=charIDToTypeID("Hd  "),r=new ActionDescriptor,i=charIDToTypeID("null"),c=new ActionList,u=new ActionReference,p=charIDToTypeID("Lyr ");if(e)u.putName(p,e);else{var l=charIDToTypeID("Ordn"),s=charIDToTypeID("Trgt");u.putEnumerated(p,l,s)}c.putReference(u),r.putList(i,c),executeAction(a,r,DialogModes.NO)}},Show:function(e){if(e instanceof Array)for(var t=0,n=e;t<n.length;t++){var o=n[t];this.Show(o)}else{var a=charIDToTypeID("Shw "),r=new ActionDescriptor,i=charIDToTypeID("null"),c=new ActionList,u=new ActionReference,p=charIDToTypeID("Lyr ");if(e)u.putName(p,e),c.putReference(u);else{var l=charIDToTypeID("Ordn"),s=charIDToTypeID("Trgt");u.putEnumerated(p,l,s),c.putReference(u)}r.putList(i,c),executeAction(a,r,DialogModes.NO)}},visible:function(){}},UnitValue:function(e,t){if("string"==typeof e){e.match(/px/)&&(t="px"),e.match(/in/)&&(t="in");var n=e.match(/\d+/);e=n?+n[0]:1}return t||(t="px"),new UnitValue(e,t)},openImages:function(e){var t=new ActionDescriptor,n=stringIDToTypeID("dontRecord");t.putBoolean(n,!1);var o=stringIDToTypeID("forceNotify");t.putBoolean(o,!0);var a=charIDToTypeID("null");t.putPath(a,new File(e));var r=charIDToTypeID("DocI");t.putInteger(r,228),executeAction(charIDToTypeID("Opn "),t,DialogModes.NO)},ArrayHas:function(e,t){for(var n=0,o=e;n<o.length;n++){if(t==o[n])return!0}return!1},StringArrayHas:function(e,t){for(var n=0,o=e;n<o.length;n++){var a=o[n];if(t&&a+"".match(t))return!0}return!1},ActiveDocumentDirName:function(){var e,t;return(null===(t=null===(e=null===app||void 0===app?void 0:app.activeDocument)||void 0===e?void 0:e.path)||void 0===t?void 0:t.displayName)||""},ActiveDocumentDirPath:function(){var e,t;return(null===(t=null===(e=null===app||void 0===app?void 0:app.activeDocument)||void 0===e?void 0:e.path)||void 0===t?void 0:t.fsName)||""},ActiveDocumentFilePath:function(){var e,t,n;return((null===(t=null===(e=null===app||void 0===app?void 0:app.activeDocument)||void 0===e?void 0:e.path)||void 0===t?void 0:t.fsName)+"\\"+(null===(n=null===app||void 0===app?void 0:app.activeDocument)||void 0===n?void 0:n.name)||"").replace(/[\\\/]+/g,"")},ActiveDocumentName:function(){var e;return(null===(e=null===app||void 0===app?void 0:app.activeDocument)||void 0===e?void 0:e.name)||""}};HM.ActiveDocumentFilePath()||alert("当前未打开文档"),console.setLogFile("~/Desktop/log.txt");var DefaultSavaDirPath="~/Pictures/Saved Pictures/kiic",is_build=!!HM.ActiveDocumentName().match(/build[.]psd/i),is_Add_Flowers=!1,Match_Drew_REGEXP=/!--单面_DrewT恤带阴影800|!--单面_T恤带阴影800|!--单面_DrewT恤带阴影1200|!--单面_T恤带阴影1200/;function UserQuery(){var e=HM.ActiveDocumentName();return!!e.match(Match_Drew_REGEXP)||!!e.match(/详情[.](psd|psb)/i)}function is_HandlingColor(e){for(var t=e.replace(/背面|正面|前面|后面|背部/,""),n=0,o=ColorList;n<o.length;n++){if(o[n]==t)return!0}return!1}function is_BlackPrints(e){var t=e.replace(/背面|正面|前面|后面|背部/,"");if("灰色"==t&&HM.ActiveDocumentFilePath().match(/2299|2298|2296|2295|2293/))return!0;for(var n=0,o=PushBlackPrintsList;n<o.length;n++){if(o[n]==t)return!0}return!1}function SwitchColorSelectFlowers(e){try{is_BlackPrints(e)?app.doAction("ShowBlackFlower","HM"):app.doAction("ShowWhiteFlower","HM")}catch(e){}}function ExportImages(e){var t=!1,n=HM.envDoc.AllLayers(),o=[];for(var a=0,r=n;a<r.length;a++){var i=r[a];"LayerKind.NORMAL"==i.kind&&HM.ArrayHas(["黑","白","中性灰"],i.name)&&HM.Layer.Hide(i.name),"LEE实物吊牌"==i.name&&(t=!0),is_HandlingColor(i.name)&&(o.push(i),HM.Layer.Hide(i.name))}var c=!1;function u(e){return t?c?(console.log(e+"=>透明不参与"),!1):e.match(/背面|后面|背部/)?(console.log(e+"不参与"),!1):!HM.ActiveDocumentFilePath().match(/2299|2296/)||(console.log(e+"连帽不参与"),!1):(console.log(e+"=>强制不参与"),!1)}var p=app.activeDocument.height;is_build||UserQuery()?c=!0:(is_Add_Flowers=confirm("Print?"),c=confirm("ToPNG?"));var l=HM.ActiveDocumentName().match(Match_Drew_REGEXP);if(is_Add_Flowers)try{app.doAction("Hidd_All_Flower","HM")}catch(e){}if(console.log("\n    is_build:".concat(is_build,",\n    is_Drew:").concat(l,",\n    ")),!is_build&&!l)for(var s=0,v=o;s<v.length;s++){var D=v[s];is_HandlingColor(D.name)&&(is_Add_Flowers&&SwitchColorSelectFlowers(D.name),c?HM.SaveLayerToPNG(DefaultSavaDirPath+"/"+D.name,D.name):HM.SaveLayerToJPEG(DefaultSavaDirPath+"/"+D.name,D.name))}if(is_build&&!l){HM.ActiveDocumentName().match(/(1200|800)[.](ps[db])/i)||(c=!1);for(var d=0,h=o;d<h.length;d++){var m=h[d];if(is_HandlingColor(m.name)){var T=1200==p?"/1200透明/":"/800透明/";c?HM.SaveLayerToPNG(DefaultSavaDirPath+T+m.name,m.name):HM.SaveLayerToJPEG(DefaultSavaDirPath+T+m.name,m.name)}}}l&&function(){var e="Drew";console.log("Doc=>".concat(HM.ActiveDocumentFilePath(),"=>_DrewType=").concat(e)),l&&(e=HM.ActiveDocumentName().match(/Drew/)?"Drew":"King");var t=DefaultSavaDirPath+"/"+e;function n(){for(var e=0,n=o;e<n.length;e++){var a=n[e];is_HandlingColor(a.name)&&(console.log("".concat(a.name,"=>").concat(u(a.name))),u(a.name)?HM.Layer.Show("LEE实物吊牌"):HM.Layer.Hide("LEE实物吊牌"),c?HM.SaveLayerToPNG(t+a.name,a.name):HM.SaveLayerToJPEG(t+a.name,a.name))}}800==p?(c=!1,t=DefaultSavaDirPath+"/"+e+"/SKU/",app.doAction("Dr_invoke_导出SKU","Build"),n(),t=DefaultSavaDirPath+"/"+e+"/800/",app.doAction("Dr_invoke_导出主图","Build"),n(),c=!0,t=DefaultSavaDirPath+"/"+e+"/透明/",app.doAction("Dr_invoke_导出透明","Build"),n()):(c=!1,t=DefaultSavaDirPath+"/"+e+"/1200/",n())}(),e?(HM.Layer.Show(function(){if(o.length)for(var e=0;e<1e3;e++){var t=Math.floor(10*Math.random());if(o.length>t)return o[t].name}}()),is_build&&app.activeDocument.close(SaveOptions.SAVECHANGES)):is_build&&app.activeDocument.close(SaveOptions.DONOTSAVECHANGES)}if(is_build)for(var envAllLayers=["详情","800","1200","!--单面_DrewT恤带阴影800","!--单面_DrewT恤带阴影1200","!--单面_T恤带阴影1200","!--单面_T恤带阴影800"],_i=0,envAllLayers_1=envAllLayers;_i<envAllLayers_1.length;_i++){var For_LayerName=envAllLayers_1[_i];HM.Layer.EditSmartObject(For_LayerName),"详情"==For_LayerName?(HM.Web_JPEG_ExportSlice(DefaultSavaDirPath+"/详情","/"),app.activeDocument.close(SaveOptions.DONOTSAVECHANGES)):ExportImages(!0)}else ExportImages();console.fileOut&&console.fileOut.close();