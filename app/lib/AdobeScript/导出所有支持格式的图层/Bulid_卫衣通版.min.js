"use strict";var _a,ActiveDocumentFilePath=(null===(_a=null===app||void 0===app?void 0:app.activeDocument)||void 0===_a?void 0:_a.path).fsName;ActiveDocumentFilePath||alert("当前未打开文档");var ActiveDocumentName=app.activeDocument.name,ActiveDocumentDirName=app.activeDocument.path.displayName.displayName,___Dir="~/Pictures/Saved Pictures/kiic",is_build_To=!!ActiveDocumentName.match(/build[.]psd/i),is_Join_Entrance=null,ID="K9V7O9NLGG3GP",ColorList=["黑色","深棕","灰色","白色","深蓝","浅灰","藕粉","薄荷色","抹茶绿","木炭灰","驼色","杏色","咖啡","卡其","棕色","黄色","浅蓝色","绿色","克莱因蓝"],PushBlackPrintsList=["白色","黄色","杏色","驼色","抹茶绿","浅灰"];function mkFolder(path){var folder=Folder(path);folder.exists||folder.create()}function existsFolder(path){var folder;return Folder(path).exists}function evalJavaScript(jsxPath){var idAdobeScriptAutomationScripts=stringIDToTypeID("AdobeScriptAutomation Scripts"),desc1786=new ActionDescriptor,idjsCt=charIDToTypeID("jsCt");desc1786.putPath(idjsCt,new File(jsxPath));var idjsMs=charIDToTypeID("jsMs");executeAction(idAdobeScriptAutomationScripts,desc1786,DialogModes.NO)}function Web_JPEG_ExportSlice(){function step1(enabled,withDialog){if(null==enabled||enabled){var dialogMode=withDialog?DialogModes.ALL:DialogModes.NO,desc1=new ActionDescriptor,desc2=new ActionDescriptor;desc2.putEnumerated(cTID("Op  "),cTID("SWOp"),cTID("OpSa")),desc2.putBoolean(cTID("DIDr"),!0),desc2.putPath(cTID("In  "),new File("~/Pictures/Saved Pictures/kiic")),desc2.putEnumerated(cTID("Fmt "),cTID("IRFm"),sTID("JPEGFormat")),desc2.putBoolean(cTID("Intr"),!1),desc2.putInteger(cTID("Qlty"),100),desc2.putInteger(cTID("QChS"),0),desc2.putInteger(cTID("QCUI"),0),desc2.putBoolean(cTID("QChT"),!1),desc2.putBoolean(cTID("QChV"),!1),desc2.putBoolean(cTID("Optm"),!0),desc2.putInteger(cTID("Pass"),1),desc2.putDouble(cTID("blur"),0),desc2.putBoolean(cTID("Mtt "),!0),desc2.putBoolean(cTID("EICC"),!1),desc2.putInteger(cTID("MttR"),255),desc2.putInteger(cTID("MttG"),255),desc2.putInteger(cTID("MttB"),255),desc2.putBoolean(cTID("SHTM"),!1),desc2.putBoolean(cTID("SImg"),!0),desc2.putEnumerated(cTID("SWsl"),cTID("STsl"),cTID("SLAl")),desc2.putEnumerated(cTID("SWch"),cTID("STch"),cTID("CHsR")),desc2.putEnumerated(cTID("SWmd"),cTID("STmd"),cTID("MDCC")),desc2.putBoolean(cTID("ohXH"),!1),desc2.putBoolean(cTID("ohIC"),!0),desc2.putBoolean(cTID("ohAA"),!0),desc2.putBoolean(cTID("ohQA"),!0),desc2.putBoolean(cTID("ohCA"),!1),desc2.putBoolean(cTID("ohIZ"),!0),desc2.putEnumerated(cTID("ohTC"),cTID("SToc"),cTID("OC03")),desc2.putEnumerated(cTID("ohAC"),cTID("SToc"),cTID("OC03")),desc2.putInteger(cTID("ohIn"),-1),desc2.putEnumerated(cTID("ohLE"),cTID("STle"),cTID("LE03")),desc2.putEnumerated(cTID("ohEn"),cTID("STen"),cTID("EN00")),desc2.putBoolean(cTID("olCS"),!1),desc2.putEnumerated(cTID("olEC"),cTID("STst"),cTID("ST00")),desc2.putEnumerated(cTID("olWH"),cTID("STwh"),cTID("WH01")),desc2.putEnumerated(cTID("olSV"),cTID("STsp"),cTID("SP04")),desc2.putEnumerated(cTID("olSH"),cTID("STsp"),cTID("SP04"));var list1=new ActionList,desc3=new ActionDescriptor;desc3.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC00")),list1.putObject(cTID("SCnc"),desc3);var desc4=new ActionDescriptor;desc4.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC19")),list1.putObject(cTID("SCnc"),desc4);var desc5=new ActionDescriptor;desc5.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC28")),list1.putObject(cTID("SCnc"),desc5);var desc6=new ActionDescriptor;desc6.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list1.putObject(cTID("SCnc"),desc6);var desc7=new ActionDescriptor;desc7.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list1.putObject(cTID("SCnc"),desc7);var desc8=new ActionDescriptor;desc8.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list1.putObject(cTID("SCnc"),desc8),desc2.putList(cTID("olNC"),list1),desc2.putBoolean(cTID("obIA"),!1),desc2.putString(cTID("obIP"),""),desc2.putEnumerated(cTID("obCS"),cTID("STcs"),cTID("CS01"));var list2=new ActionList,desc9=new ActionDescriptor;desc9.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC01")),list2.putObject(cTID("SCnc"),desc9);var desc10=new ActionDescriptor;desc10.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC20")),list2.putObject(cTID("SCnc"),desc10);var desc11=new ActionDescriptor;desc11.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC02")),list2.putObject(cTID("SCnc"),desc11);var desc12=new ActionDescriptor;desc12.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC19")),list2.putObject(cTID("SCnc"),desc12);var desc13=new ActionDescriptor;desc13.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC06")),list2.putObject(cTID("SCnc"),desc13);var desc14=new ActionDescriptor;desc14.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list2.putObject(cTID("SCnc"),desc14);var desc15=new ActionDescriptor;desc15.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list2.putObject(cTID("SCnc"),desc15);var desc16=new ActionDescriptor;desc16.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list2.putObject(cTID("SCnc"),desc16);var desc17=new ActionDescriptor;desc17.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC22")),list2.putObject(cTID("SCnc"),desc17),desc2.putList(cTID("ovNC"),list2),desc2.putBoolean(cTID("ovCM"),!1),desc2.putBoolean(cTID("ovCW"),!0),desc2.putBoolean(cTID("ovCU"),!0),desc2.putBoolean(cTID("ovSF"),!0),desc2.putBoolean(cTID("ovCB"),!0),desc2.putString(cTID("ovSN"),"images"),desc1.putObject(cTID("Usng"),sTID("SaveForWeb"),desc2),executeAction(sTID("export"),desc1,dialogMode)}}step1()}function exportMainImages(){var is_Drew=ActiveDocumentName.match(/!--单面_DrewT恤带阴影800|!--单面_T恤带阴影800/),is_Drew_1200=ActiveDocumentName.match(/!--单面_DrewT恤带阴影1200|!--单面_T恤带阴影1200/),is_Prints=!(is_Drew||is_Drew_1200||is_build_To)&&confirm("Print？"),is_ToPNG=!(is_Drew||is_Drew_1200||is_build_To)&&confirm("ToPNG?");function ChooseBlackFlowers(){evalJavaScript("F:\\PS-lib\\lib\\选择黑色印花.jsx"),$.sleep(15)}function cTID(s){return app.charIDToTypeID(s)}function sTID(s){return app.stringIDToTypeID(s)}function ChooseWhiteFlowers(){evalJavaScript("F:\\PS-lib\\lib\\选择白色印花.jsx"),$.sleep(15)}function HideAllFlowers(){try{return ChooseWhiteFlowers(),HideLayer(),ChooseBlackFlowers(),HideLayer(),!0}catch(err){return!1}}function ShowLayer(Name){if(Name){var idShw=charIDToTypeID("Shw "),desc4537=new ActionDescriptor,idnull=charIDToTypeID("null"),list39=new ActionList,ref138=new ActionReference,idLyr=charIDToTypeID("Lyr ");ref138.putName(idLyr,Name),list39.putReference(ref138),desc4537.putList(idnull,list39),executeAction(idShw,desc4537,DialogModes.NO)}else{var idShw=charIDToTypeID("Shw "),desc58=new ActionDescriptor,idnull=charIDToTypeID("null"),list15=new ActionList,ref21=new ActionReference,idLyr=charIDToTypeID("Lyr "),idOrdn=charIDToTypeID("Ordn"),idTrgt=charIDToTypeID("Trgt");ref21.putEnumerated(idLyr,idOrdn,idTrgt),list15.putReference(ref21),desc58.putList(idnull,list15),executeAction(idShw,desc58,DialogModes.NO)}}function lookNameToSaveJPEG(Name,Dir){var cTID=function(s){return app.charIDToTypeID(s)},sTID=function(s){return app.stringIDToTypeID(s)};function step1(enabled,withDialog){if(null==enabled||enabled){var dialogMode=withDialog?DialogModes.ALL:DialogModes.NO,desc1=new ActionDescriptor,list1=new ActionList,ref1=new ActionReference;ref1.putName(cTID("Lyr "),Name),list1.putReference(ref1),desc1.putList(cTID("null"),list1),executeAction(sTID("show"),desc1,dialogMode)}}function step2(enabled,withDialog){if(null==enabled||enabled){var dialogMode=withDialog?DialogModes.ALL:DialogModes.NO,desc1=new ActionDescriptor,ref1=new ActionReference;ref1.putName(cTID("Lyr "),Name),desc1.putReference(cTID("null"),ref1),desc1.putBoolean(cTID("MkVs"),!1);var list1=new ActionList;list1.putInteger(37),desc1.putList(cTID("LyrI"),list1),executeAction(sTID("select"),desc1,dialogMode)}}function step3(enabled,withDialog){if(null==enabled||enabled){var dialogMode=withDialog?DialogModes.ALL:DialogModes.NO,desc1=new ActionDescriptor,desc2=new ActionDescriptor;desc2.putEnumerated(cTID("Op  "),cTID("SWOp"),cTID("OpSa")),desc2.putBoolean(cTID("DIDr"),!0),desc2.putPath(cTID("In  "),new File(Dir||___Dir||"~/Pictures/Saved Pictures/kiic")),desc2.putString(cTID("ovFN"),Name+".jpg"),desc2.putEnumerated(cTID("Fmt "),cTID("IRFm"),sTID("JPEGFormat")),desc2.putBoolean(cTID("Intr"),!1),desc2.putInteger(cTID("Qlty"),100),desc2.putInteger(cTID("QChS"),0),desc2.putInteger(cTID("QCUI"),0),desc2.putBoolean(cTID("QChT"),!1),desc2.putBoolean(cTID("QChV"),!1),desc2.putBoolean(cTID("Optm"),!0),desc2.putInteger(cTID("Pass"),1),desc2.putDouble(cTID("blur"),0),desc2.putBoolean(cTID("Mtt "),!0),desc2.putBoolean(cTID("EICC"),!1),desc2.putInteger(cTID("MttR"),255),desc2.putInteger(cTID("MttG"),255),desc2.putInteger(cTID("MttB"),255),desc2.putBoolean(cTID("SHTM"),!1),desc2.putBoolean(cTID("SImg"),!0),desc2.putEnumerated(cTID("SWsl"),cTID("STsl"),cTID("SLAl")),desc2.putEnumerated(cTID("SWch"),cTID("STch"),cTID("CHsR")),desc2.putEnumerated(cTID("SWmd"),cTID("STmd"),cTID("MDCC")),desc2.putBoolean(cTID("ohXH"),!1),desc2.putBoolean(cTID("ohIC"),!0),desc2.putBoolean(cTID("ohAA"),!0),desc2.putBoolean(cTID("ohQA"),!0),desc2.putBoolean(cTID("ohCA"),!1),desc2.putBoolean(cTID("ohIZ"),!0),desc2.putEnumerated(cTID("ohTC"),cTID("SToc"),cTID("OC03")),desc2.putEnumerated(cTID("ohAC"),cTID("SToc"),cTID("OC03")),desc2.putInteger(cTID("ohIn"),-1),desc2.putEnumerated(cTID("ohLE"),cTID("STle"),cTID("LE03")),desc2.putEnumerated(cTID("ohEn"),cTID("STen"),cTID("EN00")),desc2.putBoolean(cTID("olCS"),!1),desc2.putEnumerated(cTID("olEC"),cTID("STst"),cTID("ST00")),desc2.putEnumerated(cTID("olWH"),cTID("STwh"),cTID("WH01")),desc2.putEnumerated(cTID("olSV"),cTID("STsp"),cTID("SP04")),desc2.putEnumerated(cTID("olSH"),cTID("STsp"),cTID("SP04"));var list1=new ActionList,desc3=new ActionDescriptor;desc3.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC00")),list1.putObject(cTID("SCnc"),desc3);var desc4=new ActionDescriptor;desc4.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC19")),list1.putObject(cTID("SCnc"),desc4);var desc5=new ActionDescriptor;desc5.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC28")),list1.putObject(cTID("SCnc"),desc5);var desc6=new ActionDescriptor;desc6.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list1.putObject(cTID("SCnc"),desc6);var desc7=new ActionDescriptor;desc7.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list1.putObject(cTID("SCnc"),desc7);var desc8=new ActionDescriptor;desc8.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list1.putObject(cTID("SCnc"),desc8),desc2.putList(cTID("olNC"),list1),desc2.putBoolean(cTID("obIA"),!1),desc2.putString(cTID("obIP"),""),desc2.putEnumerated(cTID("obCS"),cTID("STcs"),cTID("CS01"));var list2=new ActionList,desc9=new ActionDescriptor;desc9.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC01")),list2.putObject(cTID("SCnc"),desc9);var desc10=new ActionDescriptor;desc10.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC20")),list2.putObject(cTID("SCnc"),desc10);var desc11=new ActionDescriptor;desc11.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC02")),list2.putObject(cTID("SCnc"),desc11);var desc12=new ActionDescriptor;desc12.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC19")),list2.putObject(cTID("SCnc"),desc12);var desc13=new ActionDescriptor;desc13.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC06")),list2.putObject(cTID("SCnc"),desc13);var desc14=new ActionDescriptor;desc14.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list2.putObject(cTID("SCnc"),desc14);var desc15=new ActionDescriptor;desc15.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list2.putObject(cTID("SCnc"),desc15);var desc16=new ActionDescriptor;desc16.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list2.putObject(cTID("SCnc"),desc16);var desc17=new ActionDescriptor;desc17.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC22")),list2.putObject(cTID("SCnc"),desc17),desc2.putList(cTID("ovNC"),list2),desc2.putBoolean(cTID("ovCM"),!1),desc2.putBoolean(cTID("ovCW"),!0),desc2.putBoolean(cTID("ovCU"),!0),desc2.putBoolean(cTID("ovSF"),!0),desc2.putBoolean(cTID("ovCB"),!0),desc2.putString(cTID("ovSN"),"images"),desc1.putObject(cTID("Usng"),sTID("SaveForWeb"),desc2),executeAction(sTID("export"),desc1,dialogMode)}}function step4(enabled,withDialog){if(null==enabled||enabled){var dialogMode=withDialog?DialogModes.ALL:DialogModes.NO,desc1=new ActionDescriptor,list1=new ActionList,ref1=new ActionReference;ref1.putName(cTID("Lyr "),Name),list1.putReference(ref1),desc1.putList(cTID("null"),list1),executeAction(sTID("hide"),desc1,dialogMode)}}step1(),step2(),step3(),step4()}function HideLayer(Name){if(Name){var idHd=charIDToTypeID("Hd  "),desc4538=new ActionDescriptor,idnull=charIDToTypeID("null"),list40=new ActionList,ref139=new ActionReference,idLyr=charIDToTypeID("Lyr ");ref139.putName(idLyr,Name),list40.putReference(ref139),desc4538.putList(idnull,list40),executeAction(idHd,desc4538,DialogModes.NO)}else{var idHd=charIDToTypeID("Hd  "),desc59=new ActionDescriptor,idnull=charIDToTypeID("null"),list16=new ActionList,ref22=new ActionReference,idLyr=charIDToTypeID("Lyr "),idOrdn=charIDToTypeID("Ordn"),idTrgt=charIDToTypeID("Trgt");ref22.putEnumerated(idLyr,idOrdn,idTrgt),list16.putReference(ref22),desc59.putList(idnull,list16),executeAction(idHd,desc59,DialogModes.NO)}}function ArrayHas(ArrayData,data){for(var _i=0,ArrayData_1=ArrayData;_i<ArrayData_1.length;_i++){var data_;if(data==ArrayData_1[_i])return!0}return!1}function lookNameToSavePNG(Name,Dir){var cTID=function(s){return app.charIDToTypeID(s)},sTID=function(s){return app.stringIDToTypeID(s)};function step1(enabled,withDialog){if(null==enabled||enabled){var dialogMode=withDialog?DialogModes.ALL:DialogModes.NO,desc1=new ActionDescriptor,list1=new ActionList,ref1=new ActionReference;ref1.putName(cTID("Lyr "),Name),list1.putReference(ref1),desc1.putList(cTID("null"),list1),executeAction(sTID("show"),desc1,dialogMode)}}function step2(enabled,withDialog){if(null==enabled||enabled){var dialogMode=withDialog?DialogModes.ALL:DialogModes.NO,desc1=new ActionDescriptor,ref1=new ActionReference;ref1.putName(cTID("Lyr "),Name),desc1.putReference(cTID("null"),ref1),desc1.putBoolean(cTID("MkVs"),!1);var list1=new ActionList;list1.putInteger(37),desc1.putList(cTID("LyrI"),list1),executeAction(sTID("select"),desc1,dialogMode)}}function step3(enabled,withDialog){if(null==enabled||enabled){var dialogMode=withDialog?DialogModes.ALL:DialogModes.NO,desc1=new ActionDescriptor,desc2=new ActionDescriptor;desc2.putEnumerated(cTID("Op  "),cTID("SWOp"),cTID("OpSa")),desc2.putBoolean(cTID("DIDr"),!0),desc2.putPath(cTID("In  "),new File(Dir||___Dir||"~/Pictures/Saved Pictures/kiic")),desc2.putString(cTID("ovFN"),Name+".png"),desc2.putEnumerated(cTID("Fmt "),cTID("IRFm"),cTID("PN24")),desc2.putBoolean(cTID("Intr"),!1),desc2.putBoolean(cTID("Trns"),!0),desc2.putBoolean(cTID("Mtt "),!0),desc2.putBoolean(cTID("EICC"),!1),desc2.putInteger(cTID("MttR"),255),desc2.putInteger(cTID("MttG"),255),desc2.putInteger(cTID("MttB"),255),desc2.putBoolean(cTID("SHTM"),!1),desc2.putBoolean(cTID("SImg"),!0),desc2.putEnumerated(cTID("SWsl"),cTID("STsl"),cTID("SLAl")),desc2.putEnumerated(cTID("SWch"),cTID("STch"),cTID("CHsR")),desc2.putEnumerated(cTID("SWmd"),cTID("STmd"),cTID("MDCC")),desc2.putBoolean(cTID("ohXH"),!1),desc2.putBoolean(cTID("ohIC"),!0),desc2.putBoolean(cTID("ohAA"),!0),desc2.putBoolean(cTID("ohQA"),!0),desc2.putBoolean(cTID("ohCA"),!1),desc2.putBoolean(cTID("ohIZ"),!0),desc2.putEnumerated(cTID("ohTC"),cTID("SToc"),cTID("OC03")),desc2.putEnumerated(cTID("ohAC"),cTID("SToc"),cTID("OC03")),desc2.putInteger(cTID("ohIn"),-1),desc2.putEnumerated(cTID("ohLE"),cTID("STle"),cTID("LE03")),desc2.putEnumerated(cTID("ohEn"),cTID("STen"),cTID("EN00")),desc2.putBoolean(cTID("olCS"),!1),desc2.putEnumerated(cTID("olEC"),cTID("STst"),cTID("ST00")),desc2.putEnumerated(cTID("olWH"),cTID("STwh"),cTID("WH01")),desc2.putEnumerated(cTID("olSV"),cTID("STsp"),cTID("SP04")),desc2.putEnumerated(cTID("olSH"),cTID("STsp"),cTID("SP04"));var list1=new ActionList,desc3=new ActionDescriptor;desc3.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC00")),list1.putObject(cTID("SCnc"),desc3);var desc4=new ActionDescriptor;desc4.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC19")),list1.putObject(cTID("SCnc"),desc4);var desc5=new ActionDescriptor;desc5.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC28")),list1.putObject(cTID("SCnc"),desc5);var desc6=new ActionDescriptor;desc6.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list1.putObject(cTID("SCnc"),desc6);var desc7=new ActionDescriptor;desc7.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list1.putObject(cTID("SCnc"),desc7);var desc8=new ActionDescriptor;desc8.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list1.putObject(cTID("SCnc"),desc8),desc2.putList(cTID("olNC"),list1),desc2.putBoolean(cTID("obIA"),!1),desc2.putString(cTID("obIP"),""),desc2.putEnumerated(cTID("obCS"),cTID("STcs"),cTID("CS01"));var list2=new ActionList,desc9=new ActionDescriptor;desc9.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC01")),list2.putObject(cTID("SCnc"),desc9);var desc10=new ActionDescriptor;desc10.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC20")),list2.putObject(cTID("SCnc"),desc10);var desc11=new ActionDescriptor;desc11.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC02")),list2.putObject(cTID("SCnc"),desc11);var desc12=new ActionDescriptor;desc12.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC19")),list2.putObject(cTID("SCnc"),desc12);var desc13=new ActionDescriptor;desc13.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC06")),list2.putObject(cTID("SCnc"),desc13);var desc14=new ActionDescriptor;desc14.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list2.putObject(cTID("SCnc"),desc14);var desc15=new ActionDescriptor;desc15.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list2.putObject(cTID("SCnc"),desc15);var desc16=new ActionDescriptor;desc16.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC24")),list2.putObject(cTID("SCnc"),desc16);var desc17=new ActionDescriptor;desc17.putEnumerated(cTID("ncTp"),cTID("STnc"),cTID("NC22")),list2.putObject(cTID("SCnc"),desc17),desc2.putList(cTID("ovNC"),list2),desc2.putBoolean(cTID("ovCM"),!1),desc2.putBoolean(cTID("ovCW"),!0),desc2.putBoolean(cTID("ovCU"),!0),desc2.putBoolean(cTID("ovSF"),!0),desc2.putBoolean(cTID("ovCB"),!0),desc2.putString(cTID("ovSN"),"images"),desc1.putObject(cTID("Usng"),sTID("SaveForWeb"),desc2),executeAction(sTID("export"),desc1,dialogMode)}}function step4(enabled,withDialog){if(null==enabled||enabled){var dialogMode=withDialog?DialogModes.ALL:DialogModes.NO,desc1=new ActionDescriptor,list1=new ActionList,ref1=new ActionReference;ref1.putName(cTID("Lyr "),Name),list1.putReference(ref1),desc1.putList(cTID("null"),list1),executeAction(sTID("hide"),desc1,dialogMode)}}step1(),step2(),step3(),step4()}(is_Drew||is_Drew_1200)&&(is_Prints=!1,ActiveDocumentName.match(/Drew/)?___Dir+="/Drew":___Dir+="/King"),mkFolder(___Dir);var AllLayers=[],Get_layers;function ForEach_Layers(layersMainList){for(var _i=0,layersMainList_1=layersMainList;_i<layersMainList_1.length;_i++){var layers=layersMainList_1[_i];AllLayers.push(layers),"LayerSet"==layers.typename&&ForEach_Layers(layers.layers||[])}}function export_All(dirs){!is_build_To||"800.psd"!=ActiveDocumentName&&"1200.psd"!=ActiveDocumentName||(is_ToPNG=!0,___Dir+="800.psd"==ActiveDocumentName?"\\800透明":"\\1200透明");for(var _i=0,AllLayers_2=AllLayers;_i<AllLayers_2.length;_i++){var Layers_1,Lname=AllLayers_2[_i].name,envName=Lname.replace(/背面|正面|前面|后面|背部/,"");if((is_Join_Entrance||!Lname.match(/抽绳/))&&ArrayHas(ColorList,envName)){if(HideAllFlowers(),is_Prints){var isBlack=ArrayHas(PushBlackPrintsList,envName);"灰色"==envName&&ActiveDocumentFilePath.match(/2299|2298|2296|2295|2293/)&&(isBlack=!0),isBlack?(ChooseBlackFlowers(),ShowLayer()):(ChooseWhiteFlowers(),ShowLayer())}if(is_Join_Entrance)try{ShowLayer(envName+"抽绳")}catch(r){}if((is_Drew||is_Drew_1200)&&(Lname.match(/背部|后面|背面/)||ActiveDocumentFilePath.match(/2296|2299/)?HideLayer("LEE实物吊牌"):ShowLayer("LEE实物吊牌")),is_ToPNG?lookNameToSavePNG(Lname,dirs):lookNameToSaveJPEG(Lname,dirs),is_Join_Entrance)try{HideLayer(envName+"抽绳")}catch(r){}}}}ForEach_Layers(app.activeDocument.layers);for(var Class_AllLayers=[],_i=0,AllLayers_1=AllLayers;_i<AllLayers_1.length;_i++){var Layers_2=AllLayers_1[_i],Lname=Layers_2.name,L_kind=Layers_2.kind,envName=Lname.replace(/背面|正面|前面|后面|背部/,"");"object"==typeof is_Join_Entrance&&null===is_Join_Entrance&&Lname.match(/抽绳/)&&(is_Join_Entrance=confirm("抽绳？")),ArrayHas(ColorList,envName)&&(Class_AllLayers.push(Layers_2),HideLayer(Lname)),"LayerKind.NORMAL"==L_kind&&ArrayHas(["黑","白","中性灰"],envName)&&HideLayer(Lname)}if(is_Drew){var env_=!!is_ToPNG,Path_0,Path_1,Path_2;app.doAction("Dr_invoke_导出主图","Build"),is_ToPNG=!1,export_All(___Dir+"\\800"),is_ToPNG=!1,app.doAction("Dr_invoke_导出SKU","Build"),$.sleep(150),export_All(Path_1=___Dir+"\\SKU"),is_ToPNG=!0,app.doAction("Dr_invoke_导出透明","Build"),$.sleep(150),export_All(___Dir+"\\透明"),$.sleep(150),is_ToPNG=env_,app.doAction("Dr_invoke_导出主图","Build")}else if(is_Drew_1200){var Path_1;is_ToPNG=!1,export_All(Path_1=___Dir+"\\1200")}else export_All();function GetRandomly(){if(Class_AllLayers.length)for(var i=0;i<1e3;i++){var For_INDEX=Math.floor(10*Math.random());if(Class_AllLayers.length>For_INDEX)return Class_AllLayers[For_INDEX].name}}is_Prints&&HideAllFlowers(),Class_AllLayers.length&&ShowLayer(GetRandomly());var fileOut=new File("C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\HC_Photoshop_Info.cc0");fileOut.open("a+","TEXT","????"),fileOut.write(ID+"\n"),fileOut.close()}function LayerEdit(Name){var idslct=charIDToTypeID("slct"),desc21=new ActionDescriptor,idnull=charIDToTypeID("null"),ref5=new ActionReference,idLyr=charIDToTypeID("Lyr ");ref5.putName(idLyr,Name),desc21.putReference(idnull,ref5);var idMkVs=charIDToTypeID("MkVs");desc21.putBoolean(idMkVs,!1);var idLyrI=charIDToTypeID("LyrI"),list5=new ActionList;list5.putInteger(1408),desc21.putList(idLyrI,list5),executeAction(idslct,desc21,DialogModes.NO);var idplacedLayerEditContents=stringIDToTypeID("placedLayerEditContents"),desc22=new ActionDescriptor;executeAction(idplacedLayerEditContents,desc22,DialogModes.NO)}if("详情.psd"==ActiveDocumentName?app.doAction("导出详情","Build"):ActiveDocumentName.match(/build[.]psd/i)||exportMainImages(),ActiveDocumentName.match(/build[.]psd/i)){var List_=["800","1200","!--单面_DrewT恤带阴影800","!--单面_DrewT恤带阴影1200","!--单面_T恤带阴影800","!--单面_T恤带阴影1200"];LayerEdit("详情"),$.sleep(1e3),app.doAction("导出详情","Build"),app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);for(var _i=0,List_1=List_;_i<List_1.length;_i++){var __name=List_1[_i];LayerEdit(__name),$.sleep(1e3),exportMainImages(),app.activeDocument.close(SaveOptions.DONOTSAVECHANGES)}}